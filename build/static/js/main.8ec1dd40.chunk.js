(this["webpackJsonpshoplist-front"]=this["webpackJsonpshoplist-front"]||[]).push([[0],{10:function(e,t,n){e.exports=n(18)},15:function(e,t,n){},16:function(e,t,n){},18:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(8),u=n.n(c),o=(n(15),n(1)),l=(n(16),n(2)),s=n.n(l),i=n(4),m=n(3),f=function(e){var t=Object(a.useState)(""),n=Object(o.a)(t,2),r=n[0],c=n[1];return[{type:e,value:r,onChange:function(e){c(e.target.value)}},function(e){c(e||"")}]},p=function(e,t){var n=Object(a.useState)(null),r=Object(o.a)(n,2),c=r[0],u=r[1],l=Object(a.useState)([]),f=Object(o.a)(l,2),p=f[0],d=f[1];Object(a.useEffect)((function(){var n=function(){var n=Object(i.a)(s.a.mark((function n(){var a,r;return s.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,fetch(e,{headers:{Authorization:"bearer ".concat(t.token)}});case 2:return a=n.sent,n.next=5,a.json();case 5:r=n.sent,d(r);case 7:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}();try{n(),u("bearer ".concat(t.token))}catch(a){console.log(a)}}),[e,t]);var b=function(){var t=Object(i.a)(s.a.mark((function t(n){var a,r;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,fetch(e,{method:"POST",headers:{"Content-Type":"application/json",Authorization:c},body:JSON.stringify(n)});case 3:if((a=t.sent).ok){t.next=6;break}throw new Error(a.statusText);case 6:return t.next=8,a.json();case 8:r=t.sent,d(p.concat(r)),t.next=15;break;case 12:t.prev=12,t.t0=t.catch(0),console.log(t.t0);case 15:case"end":return t.stop()}}),t,null,[[0,12]])})));return function(e){return t.apply(this,arguments)}}(),v=function(){var t=Object(i.a)(s.a.mark((function t(n,a){var r,u;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,fetch("".concat(e,"/").concat(n),{method:"PUT",headers:{"Content-Type":"application/json",Authorization:c},body:JSON.stringify(a)});case 3:if((r=t.sent).ok){t.next=6;break}throw new Error(r.statusText);case 6:return t.next=8,r.json();case 8:u=t.sent,d(p.map((function(e){return e.id!==n?e:u}))),t.next=15;break;case 12:t.prev=12,t.t0=t.catch(0),console.log(t.t0);case 15:case"end":return t.stop()}}),t,null,[[0,12]])})));return function(e,n){return t.apply(this,arguments)}}(),E=function(){var e=Object(i.a)(s.a.mark((function e(t){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.links.filter((function(e){return"self"===e.rel}))[0].href,e.prev=1,e.next=4,fetch(n,{method:"DELETE"});case 4:d(Object(m.a)(Object(m.a)({},p),{},{content:p.content.filter((function(e){return e.links.filter((function(e){return"self"===e.rel}))[0].href!==n}))})),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(t){return e.apply(this,arguments)}}();return[p,{logBase:function(){console.log(e)},logToken:function(){console.log(c)},addResource:b,updateResource:v,deleteResource:E}]},d={login:function(){var e=Object(i.a)(s.a.mark((function e(t){var n,a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/api/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});case 2:if((n=e.sent).ok){e.next=5;break}throw new Error(n.statusText);case 5:return e.next=7,n.json();case 7:return a=e.sent,e.abrupt("return",a);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),create:function(){var e=Object(i.a)(s.a.mark((function e(t){var n,a,r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/api/users",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});case 2:if((n=e.sent).ok){e.next=8;break}return e.next=6,n.json();case 6:throw a=e.sent,new Error(a.error);case 8:return e.next=10,n.json();case 10:return r=e.sent,e.abrupt("return",r);case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},b=function(e){var t=e.setUser,n=Object(a.useState)(!0),c=Object(o.a)(n,2),u=c[0],l=c[1],m=f("text"),p=Object(o.a)(m,2),b=p[0],v=p[1],E=f("password"),h=Object(o.a)(E,2),O=h[0],j=h[1],g=f("text"),w=Object(o.a)(g,2),y=w[0],x=w[1],k=f("password"),S=Object(o.a)(k,2),C=S[0],L=S[1],T=function(){var e=Object(i.a)(s.a.mark((function e(n){var a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),e.prev=1,e.next=4,d.login({username:b.value,password:O.value});case 4:a=e.sent,window.localStorage.setItem("loggedListsAppUser",JSON.stringify(a)),v(),j(),t(a),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),console.log(e.t0);case 14:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(t){return e.apply(this,arguments)}}(),A=function(){var e=Object(i.a)(s.a.mark((function e(n){var a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),e.prev=1,e.next=4,d.create({username:y.value,password:C.value});case 4:return e.next=6,d.login({username:y.value,password:C.value});case 6:a=e.sent,window.localStorage.setItem("loggedListsAppUser",JSON.stringify(a)),x(),L(),t(a),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(1),console.log(e.t0);case 16:case"end":return e.stop()}}),e,null,[[1,13]])})));return function(t){return e.apply(this,arguments)}}(),U=function(){return l(!u)};return r.a.createElement("div",null,u?r.a.createElement("div",null,r.a.createElement("h1",null,"Login"),r.a.createElement("form",{onSubmit:T},r.a.createElement("div",null,"Username",r.a.createElement("input",b)),r.a.createElement("div",null,"Password",r.a.createElement("input",O)),r.a.createElement("button",{type:"submit"},"Login")),r.a.createElement("button",{onClick:function(){return U()}},"Create a new user")):r.a.createElement("div",null,r.a.createElement("h1",null,"Create a user"),r.a.createElement("form",{onSubmit:A},r.a.createElement("div",null,"Username",r.a.createElement("input",y)),r.a.createElement("div",null,"Password",r.a.createElement("input",C)),r.a.createElement("button",{type:"submit"},"Create")),r.a.createElement("button",{onClick:function(){return U()}},"Cancel")))},v=function(e){var t=e.items,n=e.purchase;return r.a.createElement("div",null,r.a.createElement("table",{border:"1"},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("td",null,"Item"),r.a.createElement("td",null,"Quantity"),r.a.createElement("td",null,"Status"))),r.a.createElement("tbody",null,t.map((function(e){return r.a.createElement("tr",{key:e.item},r.a.createElement("td",null,e.item),r.a.createElement("td",null,e.quantity),r.a.createElement("td",null,null===e.date?(t=e.item,n?r.a.createElement("button",{onClick:function(){return n(t)}},"BUY"):"Not yet purchased"):"Purchased on ".concat(new Date(e.date).toLocaleDateString())));var t})))))},E=n(9),h=function(e){var t=e.user,n=e.list,c=e.saveList,u=p("/api/items",t),l=Object(o.a)(u,2),s=l[0],i=(l[1],Object(a.useState)(n)),d=Object(o.a)(i,2),b=d[0],h=d[1],O=f("text"),j=Object(o.a)(O,2),g=j[0],w=j[1],y=f("number"),x=Object(o.a)(y,2),k=x[0],S=x[1];return r.a.createElement("div",null,r.a.createElement(v,{items:b.items}),r.a.createElement("button",{onClick:function(){return c(b)}},"Save"),r.a.createElement("form",{onSubmit:function(e){e.preventDefault(),function(e){h(Object(m.a)(Object(m.a)({},b),{},{items:[].concat(Object(E.a)(b.items),[Object(m.a)(Object(m.a)({},e),{},{date:null})])}))}({item:g.value,quantity:k.value}),w(),S()}},r.a.createElement("div",null,"Item:",r.a.createElement("input",g)),r.a.createElement("div",null,"Quantity",r.a.createElement("input",k)),r.a.createElement("button",{type:"submit"},"Add")),r.a.createElement("div",null,"Previously Added Items",r.a.createElement("table",null,r.a.createElement("tbody",null,s.map((function(e){return r.a.createElement("tr",{key:e.item},r.a.createElement("td",null,e.item),r.a.createElement("td",null,r.a.createElement("button",{onClick:function(){return w(e.item)}},"Select")))}))))))},O=function(e){var t=e.user,n=e.list,c=e.handleUpdate,u=Object(a.useState)(!1),l=Object(o.a)(u,2),s=l[0],i=l[1],f=function(){return i(!s)};return r.a.createElement("div",null,r.a.createElement("h2",null,n.name),s?r.a.createElement(h,{user:t,list:n,saveList:function(e){c(e),f()}}):r.a.createElement(v,{items:n.items,purchase:function(e){var t=Object(m.a)(Object(m.a)({},n.items.find((function(t){return t.item===e}))),{},{date:(new Date).toISOString()}),a=Object(m.a)(Object(m.a)({},n),{},{items:n.items.map((function(n){return n.item!==e?n:t}))});c(a)}}),r.a.createElement("button",{onClick:function(){return f()}},s?"Cancel":"Add items"))},j=function(e){var t=e.user,n=e.logout,c=p("/api/lists",t),u=Object(o.a)(c,2),l=u[0],s=u[1],i=Object(a.useState)(!1),m=Object(o.a)(i,2),d=m[0],b=m[1],v=f("text"),E=Object(o.a)(v,2),h=E[0],j=E[1],g=function(e){s.updateResource(e.id,e)};return r.a.createElement("div",null,r.a.createElement("p",null,"logged in as ",t.username,r.a.createElement("button",{onClick:function(){return n()}},"Logout")),r.a.createElement("h1",null,"Lists"),d?r.a.createElement("form",{onSubmit:function(e){e.preventDefault();try{var t={name:h.value};s.addResource(t),j(),b(!d)}catch(n){console.log(n)}}},r.a.createElement("div",null,"Name",r.a.createElement("input",h)),r.a.createElement("button",{type:"submit"},"Add")):"",r.a.createElement("button",{onClick:function(){return b(!d)}},d?"Cancel":"Add new List"),l.map((function(e){return r.a.createElement(O,{key:e.id,user:t,list:e,handleUpdate:g})})))},g=function(){var e=Object(a.useState)(null),t=Object(o.a)(e,2),n=t[0],c=t[1];Object(a.useEffect)((function(){var e=window.localStorage.getItem("loggedListsAppUser");if(e){var t=JSON.parse(e);c(t)}}),[]);return r.a.createElement("div",null,null===n?r.a.createElement("div",null,r.a.createElement(b,{setUser:c})):r.a.createElement("div",null,r.a.createElement(j,{user:n,logout:function(){window.localStorage.removeItem("loggedListsAppUser"),c(null)}})))};u.a.render(r.a.createElement(g,null),document.getElementById("root"))}},[[10,1,2]]]);
//# sourceMappingURL=main.8ec1dd40.chunk.js.map